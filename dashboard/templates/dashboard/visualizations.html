{% extends 'dashboard/base.html' %}

{% block content %}
<div class="text-center mb-5">
    <h1 class="display-5 fw-bold">ðŸ“Š Data Visualizations</h1>
    <p class="lead text-muted">Interactive charts and performance analysis</p>
</div>

<!-- Generated Chart -->
<div class="row mb-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4>ðŸ“ˆ Model Performance Comparison</h4>
            </div>
            <div class="card-body text-center">
                {% if chart %}
                    <img src="data:image/png;base64,{{ chart }}" class="img-fluid" alt="Model Performance Comparison">
                {% else %}
                    <p class="text-muted">Chart generation in progress...</p>
                {% endif %}
                
                <div class="mt-3">
                    <small class="text-muted">
                        Comparison of model accuracy between basic and engineered features.
                        Random Forest shows the most significant improvement with feature engineering.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Interactive Charts -->
<div class="row mb-5">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5>ðŸŽ¯ Model Accuracy Distribution</h5>
            </div>
            <div class="card-body">
                <canvas id="accuracyChart" width="400" height="300"></canvas>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5>ðŸ“Š Feature Impact Analysis</h5>
            </div>
            <div class="card-body">
                <canvas id="featureChart" width="400" height="300"></canvas>
            </div>
        </div>
    </div>
</div>

<!-- EEG Data Insights -->
<div class="row mb-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4>ðŸ§  EEG Signal Analysis</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <canvas id="eegChart" width="400" height="200"></canvas>
                    </div>
                    <div class="col-md-6">
                        <h5>Signal Characteristics</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <span class="badge bg-primary">Frequency Range:</span> 0.5 - 50 Hz
                            </li>
                            <li class="mb-2">
                                <span class="badge bg-info">Sampling Rate:</span> 128 Hz
                            </li>
                            <li class="mb-2">
                                <span class="badge bg-success">Electrode Count:</span> 14 channels
                            </li>
                            <li class="mb-2">
                                <span class="badge bg-warning">Signal Quality:</span> High SNR
                            </li>
                        </ul>
                        
                        <h6 class="mt-4">Key Electrode Positions:</h6>
                        <div class="row text-center">
                            <div class="col-3"><small class="badge bg-light text-dark">AF3</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">F7</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">F3</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">FC5</small></div>
                        </div>
                        <div class="row text-center mt-2">
                            <div class="col-3"><small class="badge bg-light text-dark">T7</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">P7</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">O1</small></div>
                            <div class="col-3"><small class="badge bg-light text-dark">O2</small></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cross-Validation Results -->
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5>ðŸ“ˆ Cross-Validation Performance</h5>
            </div>
            <div class="card-body">
                <canvas id="cvChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5>ðŸŽ¯ Prediction Confidence</h5>
            </div>
            <div class="card-body">
                <canvas id="confidenceChart" width="400" height="200"></canvas>
                
                <div class="mt-3 text-center">
                    <small class="text-muted">
                        Model confidence distribution shows high certainty in predictions,
                        indicating robust classification performance.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Model Accuracy Chart
const ctx1 = document.getElementById('accuracyChart').getContext('2d');
new Chart(ctx1, {
    type: 'radar',
    data: {
        labels: ['Random Forest', 'Gradient Boosting', 'SVM', 'Logistic Regression'],
        datasets: [{
            label: 'Basic Features',
            data: [72.96, 65.35, 56.54, 55.64],
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 2
        }, {
            label: 'Engineered Features',
            data: [98.86, 79.83, 56.16, 56.36],
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 2
        }]
    },
    options: {
        responsive: true,
        scales: {
            r: {
                beginAtZero: true,
                max: 100
            }
        }
    }
});

// Feature Impact Chart
const ctx2 = document.getElementById('featureChart').getContext('2d');
new Chart(ctx2, {
    type: 'bar',
    data: {
        labels: ['AF3', 'F7', 'F3', 'FC5', 'T7', 'P7', 'O1', 'O2'],
        datasets: [{
            label: 'Feature Importance',
            data: [0.12, 0.09, 0.11, 0.08, 0.10, 0.15, 0.18, 0.17],
            backgroundColor: [
                'rgba(255, 99, 132, 0.8)',
                'rgba(54, 162, 235, 0.8)',
                'rgba(255, 205, 86, 0.8)',
                'rgba(75, 192, 192, 0.8)',
                'rgba(153, 102, 255, 0.8)',
                'rgba(255, 159, 64, 0.8)',
                'rgba(199, 199, 199, 0.8)',
                'rgba(83, 102, 255, 0.8)'
            ]
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                title: {
                    display: true,
                    text: 'Importance Score'
                }
            }
        }
    }
});

// EEG Signal Chart
const ctx3 = document.getElementById('eegChart').getContext('2d');
const sampleData = Array.from({length: 50}, (_, i) => Math.sin(i * 0.2) + Math.random() * 0.3);
new Chart(ctx3, {
    type: 'line',
    data: {
        labels: Array.from({length: 50}, (_, i) => i),
        datasets: [{
            label: 'EEG Signal (AF3)',
            data: sampleData,
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.1)',
            tension: 0.4,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                title: {
                    display: true,
                    text: 'Amplitude (Î¼V)'
                }
            },
            x: {
                title: {
                    display: true,
                    text: 'Time (samples)'
                }
            }
        }
    }
});

// Cross-Validation Chart
const ctx4 = document.getElementById('cvChart').getContext('2d');
new Chart(ctx4, {
    type: 'line',
    data: {
        labels: ['Fold 1', 'Fold 2', 'Fold 3', 'Fold 4', 'Fold 5'],
        datasets: [{
            label: 'Random Forest CV Scores',
            data: [98.5, 98.7, 98.3, 98.9, 98.1],
            borderColor: 'rgba(54, 162, 235, 1)',
            backgroundColor: 'rgba(54, 162, 235, 0.1)',
            tension: 0.4
        }, {
            label: 'Gradient Boosting CV Scores',
            data: [80.2, 81.1, 79.8, 80.9, 80.5],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.1)',
            tension: 0.4
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: false,
                min: 75,
                max: 100,
                title: {
                    display: true,
                    text: 'Accuracy (%)'
                }
            }
        }
    }
});

// Confidence Chart
const ctx5 = document.getElementById('confidenceChart').getContext('2d');
new Chart(ctx5, {
    type: 'doughnut',
    data: {
        labels: ['High Confidence (>90%)', 'Medium Confidence (70-90%)', 'Low Confidence (<70%)'],
        datasets: [{
            data: [85, 12, 3],
            backgroundColor: [
                'rgba(75, 192, 192, 0.8)',
                'rgba(255, 205, 86, 0.8)',
                'rgba(255, 99, 132, 0.8)'
            ]
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                position: 'bottom'
            }
        }
    }
});
</script>
{% endblock %}